Refactored code for Project 1
